public class player2 : MonoBehaviour
{
    private playercontroller test;
    public bool onGround;
    private SceneColliderScript sceneColliderScript;
    public GameObject scenecolliderholder;
    public GameObject text;
    public GameObject rainhat;

    private float vertical;
    private float speed = 8f;
    private bool isLadder;
    private bool isClimbing;

    private float Speed;
    public float maxSpeed;

    public int scenetogoto;

    [SerializeField] private Rigidbody2D rb;

    // Start is called before the first frame update
    void Start()
    {
        test = playercontroller.instance;
        onGround = true;

        sceneColliderScript = scenecolliderholder.GetComponent<SceneColliderScript>();

        rainhat.SetActive(false);
    }

    private void OnCollisionEnter2D(Collision2D collision)
    {
        if (collision.gameObject.tag == "Ground")
        {
            test.p2onground = true;
        }

        if (collision.gameObject.tag == "ice")
        {
            Speed = 0.05f;
            test.player2speed = Speed;

            test.p2onground = true;
        }

        if (collision.gameObject.tag == "icicle")
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }

        if (collision.gameObject.tag == "edgecollider")
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }

    }

    private void OnCollisionExit2D(Collision2D collision)
    {
        if (collision.gameObject.tag == "ice")
        {
            Speed = maxSpeed;
            test.player2speed = maxSpeed;
        }
    }

    private void OnTriggerEnter2D(Collider2D collision)
    {
        if (collision.gameObject.tag == "SceneCollider")
        {
            sceneColliderScript.player2interacting = true;
        }

        if (collision.CompareTag("greenwall"))
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }

        if (collision.CompareTag("Ladder"))
        {
           
            GameObject ladder = collision.gameObject;
            Ladder ladderscript = ladder.GetComponent<Ladder>();

            if (ladderscript.isladdersafe || ladderscript.safeforblue)
            {
                isLadder = true;
                ladderscript.safeforblue = true;
            }
            if (!ladderscript.isladdersafe)
            {
                Destroy(gameObject);
                SceneManager.LoadScene(scenetogoto);
            }
        }

        if (collision.gameObject.tag == "xdoor")
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }

        if (collision.CompareTag("bluewall"))
        {
            rainhat.SetActive(true);
        }

        if (collision.CompareTag("Fire"))
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }

        if (collision.gameObject.tag == "teleporter")
        {
            transform.position = new Vector3(2, 2, 0);
        }

        if (collision.gameObject.tag == "spike")
        {
            Destroy(gameObject);
            SceneManager.LoadScene(scenetogoto);
        }
    }

    private void OnTriggerExit2D(Collider2D collision)
    {
        if (collision.gameObject.tag == "SceneCollider")
        {
            sceneColliderScript.player2interacting = false;
            text.SetActive(false);
        }

        if (collision.CompareTag("Ladder"))
        {
            isLadder = false;
            isClimbing = false;
        }

        if (collision.CompareTag("bluewall"))
        {
            rainhat.SetActive(false);
        }
    }

    private void Update()
    {
        vertical = Input.GetAxisRaw("Vertical");

        if (isLadder && Mathf.Abs(vertical) > 0f)
        {
            isClimbing = true;
        }
    }

    private void FixedUpdate()
    {
        if (isClimbing)
        {
            rb.gravityScale = 0f;
            rb.velocity = new Vector2(rb.velocity.x, vertical * speed);
        }
        else
        {
            rb.gravityScale = 4f;
        }
    }
}
